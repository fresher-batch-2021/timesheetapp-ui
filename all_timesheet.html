<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>All Timesheets</title>

    <link rel="stylesheet" href="styles.css">

    <!-- axios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js" 
    integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ==" 
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <header id="header">

    </header>
  
   
        <!-- append -->
        <section class="all-data">
            <table id="all-timesheet" class="all-timesheet-class" style="border:1px solid black">
                <caption>All Timesheet Listed Data</caption>
                <thead>
                    <tr>
                        <th id="table-class-head">User Id</th>
                        <th id="table-class-head">Attendance Date</th>
                        <th id="table-class-head">TaskName</th>
                        <th id="table-class-head">Time_in</th>
                        <th id="table-class-head">Time_out</th>
                        <th id="table-class-head">Total(hours)</th>
                        <th id="table-class-head">Comments</th>
                        <th id="table-class-head">Actions</th>
                    </tr>
                </thead>
                <tbody id="all-data-body">

                </tbody>
            </table>
        </section>

        <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
        <script>


   
    
        $("#header").load("header.html");
  
            


//    geeting data
let userStr = localStorage.getItem("LOGGED_IN_USER");
let user = userStr != null ? JSON.parse(userStr):null;    

// let tasksStr = localStorage.getItem("TASKS");
// let tasks = JSON.parse(tasksStr);
// console.table(tasks);
// let myTasks = tasks.filter(obj=> obj.userId == user.id);
// console.table(myTasks);

let url ="https://product-mock-api.herokuapp.com/timesheetapp/api/v1/tasks";

axios.get(url).then(res =>{

  let tasks = res.data;
//    let myTasks = tasks.filter(obj=> obj.userId == user.id);
 var content="";
 
  for(let task of tasks){
  
   content= content+`<tr><td>${task.userId}</td><td>${task.attendanceDate}</td><td>${task.name}</td><td>${task.inTime}</td><td>${task.outTime}</td><td>${task.totalHours}</td><td>${task.comments}</td><td><input type="button" id="approveButton" value="Approve" onclick="approveRow(${task.id})" /></td></tr>`;
 //   <td><img src="images/trash.png" alt=""></td>
  }
  console.log(content);
 document.querySelector("#all-data-body").innerHTML = content;
}).catch(err => {
  alert("error in getting data");

});

function approveRow(id){
    alert(id);
    
    // alert("Do you want to delete this data?");
    // const url =`https://product-mock-api.herokuapp.com/timesheetapp/api/v1/tasks/${id}`;
    // axios.delete(url).then(res => {
    //     alert("deleted succesfully");
    //     window.location.href="timesheet_record.html";
    // }).catch(err =>{
    //     alert("error in deleting");
    // });
    
  }




        </script>

    </div>

    

    
</body>
</html>